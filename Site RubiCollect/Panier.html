<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <title>Mon Panier - RubiCollect</title>
    <link rel="stylesheet" href="stylesheet.css">
    <style>
        .panier-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 20px;
        }
        
        .produit-item {
            display: flex;
            align-items: center;
            background: white;
            border: 1px solid #ddd;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }
        .produit-item:hover {
            transform: scale(1.01);
        }
        
        .img-panier {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 10px;
            margin-right: 20px;
            border: 1px solid #eee;
        }

        .produit-info {
            flex-grow: 1; 
        }
        .produit-info h3 {
            margin: 0;
            color: #465FAF;
            font-size: 1.2em;
        }
        .produit-info small {
            color: #888;
        }

        .produit-prix {
            font-weight: bold;
            font-size: 1.3em;
            color: #333;
            margin-right: 20px;
        }

        /* Bouton poubelle */
        .btn-supprimer {
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        .btn-supprimer:hover {
            background: #e84118;
        }
        
        .total-zone {
            text-align: right;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
        }
        .total-prix {
            font-size: 2em;
            font-weight: bold;
            color: #465FAF;
        }

        .actions-panier {
            display: flex;
            justify-content: flex-end; 
            gap: 15px;
            margin-top: 20px;
        }

        .btn-vider {
            background-color: #a4b0be;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
        }
        .btn-commander {
            background-color: #465FAF;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
        }
        .btn-commander:hover { background-color: #2f3542; }
    </style>
</head>
<body>

<div id="navbar">
    <img src="logo_rubicollect.png" id="logo">
    <a href="Decouvrir.html">Découvrir</a>
    <a href="Agir.html">Agir</a>
    <a href="Panier.html">
        <img src="caddie.png" class="panier">
    </a>
    <a href="Boutique.html">Boutique Solidaire</a>
</div>

<div class="main-content">
    <h1 style="text-align: center; color: #465FAF; margin-top: 30px;">Mon Panier</h1>

    <div class="panier-container">
        <div id="liste-produits"></div>

        <div id="zone-total" class="total-zone" style="display:none;">
            Total : <span id="total-panier" class="total-prix">0 €</span>

            <div class="actions-panier">
                <button onclick="viderPanier()" class="btn-vider">🗑️ Vider</button>
                <button onclick="passerCommande()" class="btn-commander">✅ Valider la commande</button>
            </div>
        </div>
    </div>
</div>

<div class="BottomBar">
    <img src="BottomBar.png" style="width:100%">
</div>

<script>
    document.addEventListener('DOMContentLoaded', afficherPanier);

    function afficherPanier() {
        const container = document.getElementById("liste-produits");
        const zoneTotal = document.getElementById("zone-total");
        const totalSpan = document.getElementById("total-panier");
        
        let panier = JSON.parse(localStorage.getItem("panier")) || [];

        container.innerHTML = "";
        
        if (panier.length === 0) {
            container.innerHTML = `
                    <div style='text-align:center; padding:40px;'>
                        <p style='font-size:1.5em; color:#888;'>Votre panier est vide</p>
                        <a href="Boutique.html" style="color:#465FAF; text-decoration:underline;">Retourner à la boutique</a>
                    </div>`;
            zoneTotal.style.display = "none";
            return;
        }
        
        zoneTotal.style.display = "block";
        let total = 0;

        panier.forEach((produit, index) => {
            let prix = parseFloat(produit.prix);
            if(isNaN(prix)) prix = 0;
            total += prix;
            let imageSrc = produit.image || "https://placehold.co/100x100?text=No+Image";

            const card = document.createElement("div");
            card.className = "produit-item";
            card.innerHTML = `
                    <img src="${imageSrc}" class="img-panier" alt="Produit">
                    
                    <div class="produit-info">
                        <h3>${produit.nom}</h3>
                        <small>Ref: ${produit.id}</small>
                    </div>

                    <span class="produit-prix">${prix} €</span>
                    
                    <button class="btn-supprimer" onclick="supprimerArticle(${index})">✕</button>
                `;
            container.appendChild(card);
        });
        
        totalSpan.innerText = total.toFixed(2) + " €";
    }
    
    function supprimerArticle(index) {
        let panier = JSON.parse(localStorage.getItem("panier")) || [];
        panier.splice(index, 1);
        localStorage.setItem("panier", JSON.stringify(panier));
        afficherPanier();
    }

    function viderPanier() {
        if(confirm("Tout supprimer ?")) {
            localStorage.removeItem("panier");
            afficherPanier();
        }
    }
    
    function passerCommande() {
        alert("🎉 Commande validée avec succès !\nMerci de votre soutien.");
        localStorage.removeItem("panier");
        window.location.href = "Boutique.html";
    }
</script>

</body>
</html>