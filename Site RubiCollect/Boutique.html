<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="stylesheet.css">
</head>
<body>
<div id="navbar">

        <img src="logo_rubicollect.png" id="logo">
        <a href="Decouvrir.html">Découvrir</a>
        <a href="Agir.html">Agir</a>
        <a href="Decouvrir.html">
            <img src="caddie.png" class="panier">
        </a>
</div>

<div class="main-content">
    <h1 style="text-align: center; color: #465FAF; margin-top: 30px;">Nos Produits</h1>
    <div id="liste-produits" class="produits-grid">
    </div>
</div>

<div class="BottomBar"><img src="BottomBar.png">
    <div class="soutenir">
        <p>N'hésitez pas à nous soutenir avec un petit don !</p>
    </div>
    <button class="ButtonDon" id="boutonDon" style="height:60px;width:100px">Faire un don</button>
    <img class="paypal" src="paypal.png" alt="paypal logo">
    <img class="cb" src="cb.png" alt="cb logo">
    <img class="robux" src="robux.png" alt="robux logo">

    <p id="message-statut" style="text-align: center; margin: 10px 0;"></p>
    
    <div class="FormulaireContact">
        <form id="contact-form-final">
            <table>
                <tr>
                    <td><p>Votre nom/âge</p></td>
                </tr>
                <tr>
                    <td><input type="text" id="firstname" name="firstname" maxlength="20" placeholder="Prénom" required></td>
                    <td><input type="text" id="lastname" name="lastname" maxlength="20" placeholder="Nom" required></td>
                    <td><input type="number" id="old" name="old" placeholder="Indiquez votre âge" required></td>
                </tr>
                <tr>
                    <td><p>Moyen de contact</p></td>
                </tr>
                <tr>
                    <td><input type="email" id="mail" name="mail" placeholder="Adresse mail" required></td>
                    <td><input type="text" id="numero" name="numero" placeholder="Numero de telephone" required></td>
                </tr>
            </table>
            <button class="ButtonContact" type="submit" style="height:60px;width:100px">Confirmer</button>
        </form>
    </div>
    <div class="avis">
        <p>Vous pouvez nous laisser un avis sur nos équipes et nos événements juste <a href="Avis.html">ici</a></p>
    </div>
</div>
<script>
    function chargerProduits() {
        const targetUrl = "https://ffw95cfxfg.execute-api.eu-north-1.amazonaws.com/produits?gp1=Romain";

        
        
        try {
            fetch(targetUrl)
            .then(response => {
                return response.json();
            })
                .then(data =>{
                    console.log(data)
                    const produits = Array.isArray(data) ? data : (data.resources || []);

                    const container = document.getElementById('liste-produits');
                    container.innerHTML = "";

                    produits.forEach(produit => {
                        container.innerHTML += `
                <div class="card">
                    <img src="${produit.image}" alt="${produit.nom}" onerror="this.src='https://placehold.co/200x200?text=Image+Manquante'">
                    <h3>${produit.nom}</h3>
                    <p style="font-weight:bold; font-size:1.2em;">${produit.prix} €</p>
                    <p>Stock : ${produit.nbStock}</p>
                    <button onclick="alert('Ajouté au panier !')">Ajouter au panier</button>
                </div>
            `;
                    });

                    if (produits.length === 0) {
                        container.innerHTML = "<p style='text-align:center; width:100%;'>Aucun produit trouvé pour le groupe Romain.</p>";
                    }
                })

        } catch (error) {
            console.error("Erreur lors de la récupération :", error);
            document.getElementById('liste-produits').innerHTML = "<p>Impossible de charger les produits.</p>";
        }
    }
    
    chargerProduits();
</script>
</body>
</html>